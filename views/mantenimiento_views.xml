<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!-- TREE: listado de mantenimientos -->
    <record id="view_logitrans_mantenimiento_tree" model="ir.ui.view">
        <field name="name">logitrans.mantenimiento.tree</field>
        <field name="model">logitrans.mantenimiento</field>
        <field name="arch" type="xml">
            <tree string="Mantenimientos">
                <field name="vehiculo_id"/>
                <field name="fecha"/>
                <field name="tipo"/>
                <field name="state"/>
                <field name="coste"/>
                <field name="realizado"/>
            </tree>
        </field>
    </record>

    <!-- FORM: ficha de mantenimiento -->
    <record id="view_logitrans_mantenimiento_form" model="ir.ui.view">
        <field name="name">logitrans.mantenimiento.form</field>
        <field name="model">logitrans.mantenimiento</field>
        <field name="arch" type="xml">
            <form string="Mantenimiento">
    <header>
        <field name="state"
               widget="statusbar"
               statusbar_visible="solicitud,programado,en_proceso,realizado,cancelado"/>

        <button name="action_programar" type="object" string="Programar"
                class="btn-primary"
                attrs="{'invisible':[('state','!=','solicitud')]}"/>

        <button name="action_iniciar" type="object" string="Iniciar"
                class="btn-primary"
                attrs="{'invisible':[('state','!=','programado')]}"/>

        <button name="action_finalizar" type="object" string="Finalizar"
                class="btn-success"
                attrs="{'invisible':[('state','!=','en_proceso')]}"/>

        <button name="action_cancelar" type="object" string="Cancelar"
                class="btn-secondary"
                attrs="{'invisible':[('state','in',['realizado','cancelado'])]}"/>
    </header>

    <sheet>
        <group>
            <group>
                <field name="vehiculo_id" required="1"/>
                <field name="fecha" required="1"/>
                <field name="tipo" required="1"/>
            </group>
            <group>
                <field name="coste"/>
                <field name="realizado" readonly="1"/>
            </group>
        </group>

        <group>
            <field name="descripcion"/>
            <field name="observaciones" placeholder="Motivo si se cancela, o notas internas..."/>
        </group>
    </sheet>
</form>


        </field>
    </record>

    <!-- ACTION: abre tree+form -->
    <record id="action_logitrans_mantenimiento" model="ir.actions.act_window">
        <field name="name">Mantenimientos</field>
        <field name="res_model">logitrans.mantenimiento</field>
        <field name="view_mode">tree,form</field>
    </record>

    <!-- MENÃš: dentro de LogiTrans -->
    <menuitem id="menu_logitrans_mantenimiento"
              name="Mantenimientos"
              parent="menu_logitrans_root"
              action="action_logitrans_mantenimiento"/>
</odoo>
